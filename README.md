# 图像取色器 (V2)

一个基于Web的交互式图像取色器，支持拖拽取样点、实时调色板预览、放大镜功能、颜色多样性算法和色库匹配功能。

## ✨ 主要功能

### 🎨 核心功能
- **图片上传**: 支持拖拽或点击上传图片（JPG、PNG、GIF格式）
- **智能取样**: 可调节颜色数量（1-20个），支持随机重新分布取样点
- **实时预览**: 拖拽取样点实时更新颜色，支持放大镜查看像素细节
- **调色板管理**: 垂直调色板显示，支持拖拽排序、删除、选择操作

### 🔍 放大镜功能
- 选中取样点时显示放大镜
- 实时显示取样点周围的像素网格
- 拖动取样点时像素实时更新
- 不遮挡图片预览区域

### 🎯 颜色多样性算法
- 基于Lab色彩空间的ΔE76色差计算
- 空间距离约束，避免取样点过近
- 感知色差优化，确保颜色多样性
- 仅在初始生成和随机分布时使用

### 🎨 色库匹配功能
- **智能匹配**: 使用Lab色彩空间计算最接近的标准色
- **批量处理**: 一键匹配调色板中所有颜色
- **详细结果**: 显示原始颜色、匹配颜色、ID和色差
- **便捷导出**: 一键复制匹配后的ID数组

## 🚀 快速开始

### 本地开发
```bash
# 克隆项目
git clone <repository-url>
cd colorpick

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

### 生产构建
```bash
# 构建生产版本
npm run build

# 预览构建结果
npm run preview
```

## 📖 使用说明

### 基本操作流程
1. **上传图片**: 拖拽或点击上传区域选择图片
2. **设置数量**: 使用滑块或±按钮调整颜色数量
3. **取样操作**: 
   - 拖拽取样点调整位置
   - 点击取样点选中/取消选中
   - 使用"随机重新分布取样点"优化颜色多样性
4. **调色板管理**:
   - 拖拽色块重新排序
   - 选中色块后点击"×"删除
   - 拖拽手柄图标进行排序
5. **导出结果**:
   - 点击"匹配色库"进行标准色匹配

### 颜色匹配功能
1. **点击"匹配色库"按钮**
2. **查看匹配结果弹窗**:
   - 上部分：最终ID数组（可一键复制）
   - 下部分：详细匹配列表，包含：
     - 序号
     - 调色板中的颜色色块和HEX代码
     - 匹配到的色库颜色和HEX代码
     - 对应的ID编号
     - 色差值（ΔE）

## 🛠️ 技术栈

- **前端框架**: React 18 + TypeScript
- **样式**: Tailwind CSS
- **构建工具**: Vite
- **拖拽**: react-draggable
- **颜色算法**: Lab色彩空间 + ΔE76色差计算

## 📁 项目结构

```
src/
├── components/          # React组件
│   ├── Sidebar.tsx     # 左侧控制面板
│   ├── Workspace.tsx   # 右侧工作区
│   ├── ColorSamplePoint.tsx  # 颜色取样点
│   ├── ColorPalette.tsx      # 调色板
│   ├── Magnifier.tsx         # 放大镜
│   └── ColorMatchModal.tsx   # 颜色匹配弹窗
├── utils/              # 工具函数
│   └── colorUtils.ts   # 颜色处理算法
├── types/              # TypeScript类型定义
│   └── index.ts        # 接口定义
└── App.tsx             # 主应用组件
```

## 🔧 自定义色库

当前包含示例色库数据，您可以：

1. 编辑 `src/utils/colorUtils.ts` 中的 `colorLibrary` 数组
2. 按照格式 `{ "ID": 数字, "HEX": "#颜色代码" }` 添加您的色库
3. 重新构建项目即可使用

## 🌐 部署

### 本地部署
```bash
# 构建项目
npm run build

# 使用Python简单服务器
python3 -m http.server 8000

# 或使用Node.js serve
npx serve dist -p 8000
```

### Docker部署
```bash
# 构建镜像
docker build -t colorpick .

# 运行容器
docker run -p 80:80 colorpick
```

### 在线部署
- **GitHub Pages**: 推送到gh-pages分支
- **Netlify**: 拖拽dist文件夹到Netlify
- **Vercel**: 连接GitHub仓库自动部署
- **CDN**: 上传dist文件夹到任何静态文件托管服务

## 🎨 颜色算法说明

### Lab色彩空间
- 使用CIE Lab色彩空间进行色差计算
- 更接近人眼感知的颜色差异
- 支持亮度、色度、色相三个维度的比较

### ΔE76色差计算
- 基于CIE76标准的色差公式
- 计算两个Lab颜色之间的欧几里得距离
- 数值越小表示颜色越相似

### 多样性优化
- 空间距离约束：取样点间最小像素距离
- 感知色差约束：最小ΔE阈值
- 多次尝试：选择最优的颜色组合

## 📱 浏览器支持

- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request！

---

**注意**: 色库匹配功能需要您提供完整的色库数据。当前包含示例数据用于测试，实际使用时请替换为您的标准色库。
